---
title: "Network_Final"
author: "Nerurkar Jui A"
date: "12/14/2019"
output:
  pdf_document: default
  html_document: default
---

# Introduction: (still editing)

Effective and efficient policy making outcomes are strongly dependent on the negotiations and structures during the decision-making process. A primary assumption in the literature on collaborative and policy networks is that political outcomes are affected by a variety of state and non state actors. Past research about policy making aims at understanding how policy solutions are designed to resolve problems at the crucial agenda-setting stage and they attribute a strong role to ‘powerful’ actors in it (Ferris et al. 2007; Watkins and Rosengrant 1996).

The definition of power of the actors involved in the decision making process depends on whether policy making is considered as a process shaped by elected officials and senior public managers or rather by a variety of interdependent private and public actors (Montjoy and Watson 1995; Svara 1998). Whereas the first can be understood as institutional power defined by formal rules, the second can be characterized as informal structural power or access to political influence. 

In empirical policy networks, the two modes of power - formal power derived from institutional roles and structural power derived from network configurations - cannot be easily disentangled. Past studies highlight that integrating both institutional and structural resources into one statistical network model would help to understand the complexity of resource dependent and power (im)balance.

The authors provide a structural and institutional explanation for power differentials in policy networks and further ask what impact structural versus formal power has on the formation of policy outputs and outcomes. Hence, their research question is: what factors determine the influence reputation of political actors? 

To answer this question, they sought to investigate an antecedent condition for factual political influence and success: the reputation of an actor as being influential. They define reputation as the perceived importance of actors when evaluated by their peers or other stakeholders involved in the policy making process. The underlying assumption is that actors who have a reputation for being influential can considerably influence collective decision making. With the goal of understanding structural determinants of resources and power, they delve into two different branches of research: policy networks and collaborative networks research.

Policy networks are defined as a set of relatively stable relationships which are of a nonhierarchical and interdependent nature and link a variety of public and private actors who share common interests with regard to a specific policy (Borzel 1997, Peterson and Bomberg 2009). On the other hand, collaborative networks conceptualize decision making and implementation as a cooperative game for the common cause of policy coordination - a game during which cooperation often breaks down due to collective action problems(Ingold and Leifeld 2016). The authors follow the argument that once ties are established, they become resources and that a strategy to build better reputation is to tactically select collaboration partners to ensure that many other actors can observe the strategic role the actor is playing in the policy network. Thus, the authors posit that ‘reputation has a systemic component’ and that ‘political actors strive to occupy network positions from where they can control resource or information flows through the network, and this is rewarded by gaining a greater reputational power.’

The authors mention three important hypotheses in the paper, which are as follows:

- The higher the betweenness centrality of alter in a collaboration or contact network, the more likely ego is to report alter as being particularly influential.

- Collaboration between ego and alter leads ego to report alter as being particularly influential.

- Actors with institutional decision making power tend to be perceived as particularly influential by other actors, irrespective of their structural position in the policy network.

# Data

	The first analysis we choose to do concerns the climate change policy in Switzerland. This policy was at the national level and the data was collected during the decision making stage of the process. The main goal of the policy was to mitigate the emissions of green house gases by 10% by 2012. The data was collected at two stages, the first is at the launch of the policy and the second was when a major amendment to the policy was being decided upon. There were interviews conducted with 33 organizations involved with this legislation. The response rate was 100% and the final network included 4 government actors, 5 political parties, 11 organized interest parties, and 13 scientific, research or ecological parties. 
	
	The second analysis we choose to examine further is the Switzerland telecommunications data. This example, focuses on the actual implementation of a policy. The policy in question fully liberalized the Swiss telecommunications market. This time however, the surveys were conducted by post. The survey was sent out to 38 actors and with a 82% response rate. These included 14 government actors, 6 political parties, 13 private sector representatives and 5 trade unions. For both analysis, the data only included organizational actors as opposed to individuals. Furthermore, the actors in both cases were decided upon by a panel of experts and verified with the the respondents. 
	
	In both cases, the respondents were asked similar questions. The first question asked to the respondents was which other organizations, their organization perceived as influential. These responses were converted into a sociomatrix with senders on the rows and receivers on the columns. This sociomatrix describes the hierarchical organization of the network. To capture the structural organization, the respondents were asked which other organizations they collaborated with through the process. Since collaboration is intuitively undirected, any missing data was filled in with this assumption. Another variable collected was a binary variable describing whether an actor has any decision making power or not. 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library("network") 
library("sna")     
library("ergm")     
library("tergm")   
library("texreg")
library(latentnet)
```

# Model 1: Climate Change first period

#Data
```{r}
# data preparation
rep.1 <- read.csv2("input/climate9500-rep.csv", row.names = 1, 
    header = TRUE)
rep.1 <- network(as.matrix(rep.1))  # influence reputation network
collab.1 <- read.csv2("input/climate9500-collab.csv", row.names = 1, 
    header = TRUE)
collab.1 <- network(as.matrix(collab.1))  # collaboration network

network::set.vertex.attribute(rep.1, "bc-perc", 100 * betweenness(collab.1, 
    rescale = TRUE))  # betweenness centrality as a vertex attribute

dm.1 <- read.csv2("input/climate9500-dm.csv", row.names = 1, header = TRUE)
network::set.vertex.attribute(rep.1, "dm", dm.1$dm)  # decision-maker?
network::set.vertex.attribute(rep.1, "odeg-rep", degree(rep.1, 
    cmode = "outdegree"))  # outdegree centrality as a vertex attribute
com.1 <- read.csv2("input/climate9500-committee.csv", row.names = 1, 
    header = TRUE)
network::set.vertex.attribute(rep.1, "committees", rowSums(com.1))
    # number of committee memberships as a vertex attribute

# save summary table for the appendix
names.1 <- get.vertex.attribute(rep.1, "vertex.names")
between_collab.1 <- 100 * betweenness(collab.1, rescale = TRUE)
committee.1 <- rowSums(com.1)
type.1 <- read.csv2("input/climate9500-type.csv", row.names = 1, 
    header = TRUE)
appendix.1 <- data.frame(org = names.1, type3 = type.1[, 1], 
    type5 = type.1[, 2], committees = committee.1, dm = dm.1$dm, 
    betweenness = between_collab.1)

```

#ERGM

```{r}
climate1 <- ergm(rep.1 ~ edges + cyclicalties + transitiveties + mutual + nodeocov("odeg-rep") + edgecov(collab.1) + nodeicov("bc-perc") + nodeifactor("dm") + nodeicov("committees"),control = control.ergm(seed = 12345)
)  # ERGM (model 1)
summary(climate1)
```

#Latent Space Model

```{r}
# Check evidence for clustering, fit a set of candidate models
fits.1 <-lapply(1:2, function(G){
    ergmm(rep.1 ~ euclidean(d=2, G=G) + edges + nodeocov("odeg-rep") + edgecov(collab.1) + nodeicov("bc-perc") + nodeifactor("dm") + nodeicov("committees"), seed = 12345)
  })

# Compute the BICs
do.call(rbind,lapply(lapply(fits.1 ,bic.ergmm),as.data.frame))

#Model with two clusters has the lowest overall BIC.
```

```{r}
clim.lsm.1 <- latentnet::ergmm(rep.1 ~ euclidean(d=2, G = 2) + edges + nodeocov("odeg-rep") + edgecov(collab.1) + nodeicov("bc-perc") + nodeifactor("dm") + nodeicov("committees"), seed = 12345)
summary(clim.lsm.1)
plot(clim.lsm.1, cluster.col = c("blue", "red"))
```

Results:

The edges term is similar to a constant in linear regression models and it indicates the baseline likelihood of any dyad in the network to form a tie. This term is significant in the ergm as well as the latent space model. 
The coefficient of cyclical ties is negative, which indicates an absence of cyclical ties. This supports the theory that influence reputation is a hierarchical and acyclic social phenomenon i.e if A rates B as influential and B rates C as influential, then it is unlikely that C will rate A as influential. This term is statistically significant.
The coefficient for transitivity, which is a complementary effect that captures the hierarchical structure is positive and significant. However, in the paper this term is not statistically significant for this model.
The authors also include the term reciprocity in the ergm "to control for the potential tendency of ties to be reciprocated in order to make sure that there are no omitted dependencies when we estimate our effects of interest." This term is positive but not statistically significant.  
The outdegree centrality of ego (nodeocov.odeg-rep) controls for the number of judgments that ego makes in the whole network. In other words, this term controls for the individual baseline propensities of individuals in any dyad towards making positive or negative judgments. This term is positive and significant in both the models. 


# Model 2: Climate Change second period

#Data
```{r}
# data preparation
rep.2 <- read.csv2("input/climate0205-rep.csv", row.names = 1, 
    header = TRUE)
rep.2 <- network(as.matrix(rep.2))  # influence reputation network
collab.2 <- read.csv2("input/climate0205-collab.csv", row.names = 1, 
    header = TRUE)
collab.2 <- network(as.matrix(collab.2))  # collaboration network
network::set.vertex.attribute(rep.2, "bc-perc-2", 100 * betweenness(collab.2, 
    rescale = TRUE))  # betweenness centrality as a vertex attribute
dm.2 <- read.csv2("input/climate0205-dm.csv", row.names = 1, header = TRUE)
network::set.vertex.attribute(rep.2, "dm", dm.2$dm)  # decision-maker?
network::set.vertex.attribute(rep.2, "odeg-rep", degree(rep.2, 
    cmode = "outdegree"))  # outdegree centrality as a vertex attribute
com.2 <- read.csv2("input/climate0205-committee.csv", row.names = 1, 
    header = TRUE)
network::set.vertex.attribute(rep.2, "committees-2", rowSums(com.2))
    # number of committee memberships as a vertex attribute

# save summary table for the appendix
names.2 <- get.vertex.attribute(rep.2, "vertex.names")
between_collab.2 <- 100 * betweenness(collab.2, rescale = TRUE)
committee.2 <- rowSums(com.2)
type.2 <- read.csv2("input/climate0205-type.csv", row.names = 1, 
    header = TRUE)
appendix.2 <- data.frame(org = names.2, type3 = type.2[, 1], 
    type5 = type.2[, 2], committees = committee.2, dm = dm.2$dm, 
    betweenness = between_collab.2)
```

# ERGM
```{r}
climate2 <- ergm(rep.2 ~ edges + cyclicalties + transitiveties + mutual + nodeocov("odeg-rep") + edgecov(collab.2) + nodeicov("bc-perc-2") + nodeifactor("dm") + nodeicov("committees-2"), control = control.ergm(seed = 12345))  # ERGM (model 2)
summary(climate2)
```

#Latent Space Model

```{r}
#LSM (model 2)
# Check evidence for clustering, fit a set of candidate models
fits.2 <-lapply(1:2, function(G){
    ergmm(rep.2 ~ euclidean(d=2, G=G) + edges + nodeocov("odeg-rep") + edgecov(collab.2) + nodeicov("bc-perc-2") + nodeifactor("dm") + nodeicov("committees-2"), seed = 12345)
  })

# Compute the BICs
do.call(rbind,lapply(lapply(fits.2 ,bic.ergmm),as.data.frame))

#Model with two clusters has the lowest overall BIC.
```

```{r}
clim.lsm.2 <- ergmm(rep.2 ~ euclidean(d=2, G=2) + edges + nodeocov("odeg-rep") + edgecov(collab.2) + nodeicov("bc-perc-2") + nodeifactor("dm") + nodeicov("committees-2"), seed = 12345)
summary(clim.lsm.2)
plot(clim.lsm.2)
```

# Model 3: Telecommunications

#Data
```{r}
# data preparation
rep.3 <- read.csv2("input/telecom-rep.csv", row.names = 1, header = TRUE)
rep.3 <- network(as.matrix(rep.3))  # influence reputation network
collab.3 <- read.csv2("input/telecom-collab.csv", row.names = 1, 
    header = TRUE)
for (i in 1:nrow(collab.3)) {
  for (j in 1:ncol(collab.3)) {
    if (is.na(collab.3[i, j])) {
      collab.3[i, j] <- collab.3[j, i]
    }
    if (is.na(collab.3[i, j])) {  # i.e., both ij and ji are missing
      collab.3[i, j] <- 0
    }
  }
}
collab.3 <- network(collab.3)  # collaboration network
network::set.vertex.attribute(rep.3, "bc-perc-3", 100 * betweenness(collab.3, 
    rescale = TRUE))  # betweenness centrality as a vertex attribute
dm.3 <- read.csv2("input/telecom-dm.csv", row.names = 1, header = TRUE)
network::set.vertex.attribute(rep.3, "dm", dm.3$dm)  # decision-maker?
network::set.vertex.attribute(rep.3, "odeg-rep", degree(rep.3, 
    cmode = "outdegree"))  # outdegree centrality as a vertex attribute
committee.3 <- rowSums(read.csv2("input/telecom-committee.csv", 
    row.names = 1, header = TRUE))
network::set.vertex.attribute(rep.3, "committees-3", committee.3)
    # number of committee memberships as a vertex attribute

# save summary table for the appendix
names.3 <- get.vertex.attribute(rep.3, "vertex.names")
between_collab.3 <- 100 * betweenness(collab.3, rescale = TRUE)
type.3 <- read.csv2("input/telecom-type.csv", row.names = 1, 
    header = TRUE)
appendix.3 <- data.frame(org = names.3, type3 = type.3[, 1], 
    type5 = type.3[, 2], committees = committee.3, 
    dm = dm.3$dm, betweenness = between_collab.3)
```


# Conclusion


